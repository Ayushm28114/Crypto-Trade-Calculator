<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>‚Çø Crypto Trade Calculator</title>
    <style>
      .loading-screen {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        font-family: Arial, sans-serif;
        z-index: 9999;
      }
      .spinner {
        width: 40px;
        height: 40px;
        border: 4px solid rgba(255,255,255,0.3);
        border-top: 4px solid white;
        border-radius: 50%;
        animation: spin 1s linear infinite;
        margin: 20px 0;
      }
      @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
      }
      .error-msg {
        background: rgba(248, 113, 113, 0.2);
        border: 1px solid rgba(248, 113, 113, 0.5);
        padding: 15px;
        border-radius: 8px;
        margin: 10px;
        max-width: 500px;
        text-align: left;
      }
      .btn {
        padding: 10px 20px;
        margin: 5px;
        background: #4f46e5;
        color: white;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        text-decoration: none;
        display: inline-block;
      }
    </style>
  </head>
  <body>
    <!-- Loading screen that shows immediately -->
    <div id="loading-screen" class="loading-screen">
      <h1>üöÄ Crypto Trade Calculator</h1>
      <div class="spinner"></div>
      <p id="loading-status">Initializing application...</p>
      <div id="error-container" style="display: none;">
        <div class="error-msg">
          <h3>‚ö†Ô∏è Loading Error Detected</h3>
          <p id="error-details">Something went wrong while loading the application.</p>
          <div>
            <a href="/fallback.html" class="btn">Emergency Mode</a>
            <a href="/simple-test.html" class="btn">Diagnostics</a>
            <button onclick="window.location.reload()" class="btn">Retry</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Main app container -->
    <div id="root"></div>
    
    <!-- Emergency error detection script -->
    <script>
      console.log('=== INITIAL HTML LOADED ===');
      
      let loadingTimeout;
      let errorCount = 0;
      
      function updateStatus(message) {
        console.log('Status:', message);
        const statusEl = document.getElementById('loading-status');
        if (statusEl) statusEl.textContent = message;
      }
      
      function showError(error) {
        console.error('Error detected:', error);
        errorCount++;
        
        const errorContainer = document.getElementById('error-container');
        const errorDetails = document.getElementById('error-details');
        
        if (errorDetails) {
          errorDetails.innerHTML = `
            <strong>Error ${errorCount}:</strong> ${error}<br>
            <small>Check browser console for more details.</small><br>
            <small>Time: ${new Date().toISOString()}</small>
          `;
        }
        
        if (errorContainer) errorContainer.style.display = 'block';
      }
      
      // Set a timeout to detect if app never loads
      loadingTimeout = setTimeout(() => {
        showError('Application failed to load within 15 seconds');
      }, 15000);
      
      // Global error handlers
      window.addEventListener('error', function(event) {
        showError(`Script error: ${event.filename}:${event.lineno} - ${event.message}`);
      });
      
      window.addEventListener('unhandledrejection', function(event) {
        showError(`Promise rejection: ${event.reason}`);
      });
      
      // Function to hide loading screen (called by React)
      window.hideLoadingScreen = function() {
        console.log('React app loaded successfully');
        clearTimeout(loadingTimeout);
        const loadingScreen = document.getElementById('loading-screen');
        if (loadingScreen) {
          loadingScreen.style.display = 'none';
        }
      };
      
      updateStatus('Loading CSS and JavaScript...');
    </script>
    
    <!-- Main React application script -->
    <script type="module" src="/src/main.tsx"></script>
    
    <!-- Fallback for browsers that don't support ES modules -->
    <script nomodule>
      showError('Your browser does not support ES modules. Please update your browser.');
    </script>
  </body>
</html>
